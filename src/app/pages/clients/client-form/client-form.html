<h2 mat-dialog-title>{{ data.client ? 'Editar Cliente' : 'Novo Cliente' }}</h2>

<mat-dialog-content [formGroup]="form">
  <div class="cnpj-field-container">
    <mat-form-field appearance="fill" class="full-width">
      <mat-label>CNPJ</mat-label>
      <input matInput formControlName="cnpj" placeholder="00.000.000/0000-00" />
      <mat-error *ngIf="form.get('cnpj')?.hasError('required')">
        CNPJ é obrigatório
      </mat-error>
    </mat-form-field>
    <button *ngIf="!data.client" mat-raised-button color="accent" type="button" (click)="buscarCNPJ()" [disabled]="loadingCNPJ || !form.get('cnpj')?.value">
      {{ loadingCNPJ ? 'Buscando...' : 'Buscar CNPJ' }}
    </button>
  </div>

  <mat-form-field appearance="fill" class="full-width">
    <mat-label>Razão Social</mat-label>
    <input matInput formControlName="razao_social" />
    <mat-error *ngIf="form.get('razao_social')?.hasError('required')">
      Razão Social é obrigatória
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="fill" class="full-width">
    <mat-label>Email</mat-label>
    <input matInput formControlName="email" type="email" />
    <mat-error *ngIf="form.get('email')?.hasError('required')">
      Email é obrigatório
    </mat-error>
    <mat-error *ngIf="form.get('email')?.hasError('email') && !form.get('email')?.hasError('required')">
      Digite um email válido
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="fill" class="full-width">
    <mat-label>Endereço</mat-label>
    <input matInput formControlName="address" />
  </mat-form-field>

  <mat-form-field appearance="fill" class="full-width">
    <mat-label>Senha {{ data.client ? '(deixe em branco para não alterar)' : '' }}</mat-label>
    <input matInput type="password" formControlName="password" />
    <mat-error *ngIf="form.get('password')?.hasError('required')">
      Senha é obrigatória
    </mat-error>
    <mat-error *ngIf="form.get('password')?.hasError('minlength')">
      Senha deve ter no mínimo 12 caracteres
    </mat-error>
  </mat-form-field>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="cancel()">Cancelar</button>
  <button mat-raised-button color="primary" (click)="save()" [disabled]="submitting">
    {{ data.client ? 'Atualizar' : 'Criar' }}
  </button>
</mat-dialog-actions>
